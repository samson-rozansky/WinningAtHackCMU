<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Market Platform</title>
    <!-- Link to the corrected CSS file -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <!-- Include Socket.io and Chart.js if necessary -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.0/socket.io.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <header>
        <img src="{{ url_for('static', filename='images/blockstocks_logo.png') }}" alt="BlockStocks Logo">
        <h1>Welcome, {{ user_name }}!</h1>
    </header>

    <div class="main-container">
        <!-- Left Column: Form -->
        <div class="form-container">
            <!-- Role Selection -->
            <div class="role-selection">
                <div id="buyer-box" class="role-box">Buyer</div>
                <div id="seller-box" class="role-box seller-selected">Seller</div>
                <input type="hidden" name="role" id="role-input" value="seller">
            </div>

            <!-- Price Input -->
            <div class="price-input-wrapper">
                <input type="number" name="price" placeholder="Price" step="0.01" min="0" max="100" required>
            </div>

            <!-- Payment Methods -->
            <h3>Select Payment Method(s)</h3>
            <div class="option-box-group">
                <div class="option-box" data-value="zelle"><span class="label-text">Zelle</span></div>
                <div class="option-box" data-value="paypal"><span class="label-text">PayPal</span></div>
                <div class="option-box" data-value="venmo"><span class="label-text">Venmo</span></div>
                <div class="option-box" data-value="cashapp"><span class="label-text">CashApp</span></div>
            </div>

            <!-- Contact Methods -->
            <h3>Enter Contact Method(s)</h3>
            <div class="option-box-group">
                <input type="text" class="contact-input" name="phone" placeholder="Phone #">
                <input type="email" class="contact-input" name="email" placeholder="Email">
                <input type="text" class="contact-input" name="instagram" placeholder="Instagram username">
                <input type="text" class="contact-input" name="discord" placeholder="Discord handle">
            </div>

            <!-- Submit Button -->
            <button type="submit">Submit</button>
        </div>

        <!-- Right Column: Graph -->
        <div class="graph-container">
            <h2>Current Projected Block Price: $8.07</h2>
            <div class="graph">
                <canvas id="myChart"></canvas>
            </div>
        </div>
    </div>

    <h2 class="transactions-history">Transactions History</h2>
    <ul>
        {% for transaction in transactions %}
            <li>{{ transaction.name }} bought a block for ${{ transaction.price }} on {{ transaction.date.strftime('%Y-%m-%d') }}</li>
        {% endfor %}
    </ul>

    <!-- JavaScript Code -->
    <script>
        // Chart.js graph setup
        const labels = {{ labels | tojson }};
        const data = {
            labels: labels,
            datasets: [{
                label: 'Sales',
                backgroundColor: 'rgb(255, 99, 132)',
                borderColor: 'rgb(255, 99, 132)',
                data: {{ data | tojson }},
            }]
        };
        const config = {
            type: 'line',
            data: data,
            options: { maintainAspectRatio: false }
        };
        const myChart = new Chart(document.getElementById('myChart'), config);

        // Role selection toggling
        const buyerBox = document.getElementById('buyer-box');
        const sellerBox = document.getElementById('seller-box');
        const roleInput = document.getElementById('role-input');

        buyerBox.addEventListener('click', function () {
            buyerBox.classList.add('buyer-selected');
            sellerBox.classList.remove('seller-selected');
            roleInput.value = 'buyer';
        });

        sellerBox.addEventListener('click', function () {
            sellerBox.classList.add('seller-selected');
            buyerBox.classList.remove('buyer-selected');
            roleInput.value = 'seller';
        });

        // Payment method selection
        document.querySelectorAll('.option-box').forEach(box => {
            box.addEventListener('click', function() {
                this.classList.toggle('selected');
            });
        });
    </script>
</body>
</html>